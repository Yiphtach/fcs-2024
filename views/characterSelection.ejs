<%- include('partials/header') %> <!-- Include the header partial -->

<main>
  <h1>Choose Your Character from <%= universe %></h1>

  <!-- Display character options -->
  <form action="/fights/simulate" method="POST">
    <div class="character-selection">
      <% characters.forEach(character => { %>
        <div class="character-option">
          <input type="radio" id="char1-<%= character._id %>" name="char1Id" value="<%= character._id %>" required aria-label="<%= character.name %>" onclick="storeSelectedCharacter('<%= character._id %>')">
          <label for="char1-<%= character._id %>"><%= character.name %></label>
        </div>
      <% }) %>
    </div>

    <!-- Choose an opponent -->
    <h2>Choose Your Opponent</h2>
    <select name="char2Id" id="char2Id" required aria-label="Choose your opponent">
      <option value="" disabled selected>Select an opponent</option>
      <% characters.forEach(character => { %>
        <option value="<%= character._id %>"><%= character.name %></option>
      <% }) %>
    </select>
    
    <button type="submit" class="start-fight-button">Start Fight</button>
  </form>
</main>

<%- include('partials/footer') %> <!-- Include the footer partial -->

<!-- JavaScript to store and handle selected character -->
<script>
  let selectedCharacterId = '';

  function storeSelectedCharacter(charId) {
    selectedCharacterId = charId;
    updateOpponentOptions();
  }

  function updateOpponentOptions() {
    const opponentSelect = document.getElementById('char2Id');
    const options = opponentSelect.options;

    for (let i = 0; i < options.length; i++) {
      if (options[i].value === selectedCharacterId) {
        options[i].disabled = true; // Disable the selected character from being chosen as the opponent
      } else {
        options[i].disabled = false;
      }
    }
  }
</script>

<!-- Styles for layout -->
<style>
  .character-selection {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
  }

  .character-option {
    padding: 10px;
    background-color: #f4f4f4;
    border-radius: 5px;
    text-align: center;
    transition: background-color 0.3s ease;
  }

  .character-option:hover {
    background-color: #e0e0e0;
  }

  .start-fight-button {
    padding: 15px 25px;
    background-color: #4CAF50;
    color: white;
    text-decoration: none;
    font-size: 18px;
    border-radius: 5px;
    margin-top: 20px;
  }

  .start-fight-button:hover {
    background-color: #45a049;
  }

  select {
    padding: 10px;
    font-size: 16px;
    margin-bottom: 20px;
    width: 100%;
    border-radius: 5px;
  }
</style>
